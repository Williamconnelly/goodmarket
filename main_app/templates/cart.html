{% extends 'base.html' %}
{% block content %}
{% if has_cart == True%}
<div class="cart-wrapper">
  <div class="cart-heading group">
    <h1>My Cart</h1>
    <a href="/market">Back to Market</a>
  </div>
  <div class="cart-container">
    <!-- TODO: Color-shift on Odd/Even? -->
    <ul>
      {% for item in items %}
        <li>
          <div class="item-container">
            <div class="item-table">
              <div class="item-cell">
                <a href="/item/{{ item.id }}"><img src="/media/{{ item.image }}" alt="" class="itemImg"></a>
                <h3>{{ item.name }}</h3>
                <p>Charity {{ item.charity_percent }}%</p>
              </div>
              <div class="value-cell">
                <p>${{ item.price }}.00</p>
              </div>
              <div class="removal-cell">
                <a href="/cart/delete/{{ item.id }}/">Remove</a>
              </div>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
    <div class="subtotal-wrapper">
      <div class="subtotal">
        <ul>
          <li>
            <span class="label">Charity</span>
            <span class="label-value">{{ percentage_to_charity }}%</span>
          </li>
          <li>
            <span class="label">Charity $</span>
            <span class="label-value">$ {{ charity_sum }}</span>
          </li>
          <li>
            <span class="label total">TOTAL</span>
            <span class="labelvalue">${{ subtotal }}</span>
          </li>
          <li>
            <a class="checkout-button" href="#">Checkout</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <form action="/checkout/" method="POST">
    {% csrf_token %}
    <script
        src="https://checkout.stripe.com/checkout.js" class="stripe-button"
        data-key="{{key}}"
        data-amount="{{ subtotal }}00"
        data-name="Demo Site"
        data-description="Cart Checkout"
        data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
        data-zip-code="true"
        data-locale="auto">
    </script>
    {% for item in items %}
    <input hidden value="{{item.price}}" name="item_price"  />
    <input hidden value="{{item.charity}}" name="charity" />
    <input hidden value="{{item.charity_percent}}" name="charity_percent" />
    <input hidden value="{{item.user_id}}" name="user" />
    {% endfor %}
  </form>

</div>
{% else %}
<h1>Your Cart is Empty</h1>
{% endif %}
{% endblock %}